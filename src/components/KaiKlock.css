/*╔══════════════════════════════════════════════════════════════╗
   MΛTUSΛE · “Atlantean Lumitech” Kai-Klock™ v1.1.1-mobilefix
   Frosted-Glass • GPU-Neon • Living-Rainbow • Zero-Blur
   Responsive / No-Bleed on Mobile
╚════════════════════════════════════════════════════════════════╝
   Timing ⇢ var(--cycle)  (default 5.236s, overridden by React)
******************************************************************/

:root {
  --core  : #00eaff;
  --hue   : #00eaff;
  --arc   : #00eaff;
  --flash : #07f8ff;
  --cal   : var(--hue);
  --cycle : 5.236s;
}

/* ─── CALENDAR NEON ──────────────────────────────────────────── */
.day-solhara   { --cal: #ff1559; }
.day-aquaris   { --cal: #ff6d00; }
.day-flamora   { --cal: #ffd900; }
.day-verdari   { --cal: #00ff66; }
.day-sonari    { --cal: #05e6ff; }
.day-kaelith   { --cal: #c300ff; }

.month-aethon   { --cal: #ff1559; }
.month-virelai  { --cal: #ff6d00; }
.month-solari   { --cal: #ffd900; }
.month-amarin   { --cal: #00ff66; }
.month-kaelus   { --cal: #05e6ff; }
.month-umbriel  { --cal: #0096ff; }
.month-noctura  { --cal: #7000ff; }
.month-liora    { --cal: #c300ff; }

/* ═════════════ SHELL: Responsive, Clipped Glow ═════════════ */
.kai-klock-shell {
position: relative;
width: 100%;
max-width: 120px;
aspect-ratio: 1;
margin: auto;
border-radius: 50%;
overflow: hidden; /* 🔒 clip glow to container */
background: rgba(4,18,24,0.10);
backdrop-filter: blur(20px) saturate(1.45);
border: .065rem solid color-mix(in srgb,var(--core) 30%,transparent);
box-shadow:
  0 0 6px rgba(0,255,255,0.06) inset,
  0 0 20px rgba(0,255,255,0.08);
animation: klockBreath var(--cycle) ease-in-out infinite;
will-change: filter;
}

@keyframes klockBreath {
0%,100% {
  filter: drop-shadow(0 0 6px var(--hue));
}
50% {
  filter:
    drop-shadow(0 0 20px var(--hue))
    drop-shadow(0 0 46px color-mix(in srgb,var(--hue) 80%,transparent));
}
}

/* ─── Smooth radial glow (replaces boxy shadows) ───────────── */
.kai-klock-shell::before {
content: "";
position: absolute;
inset: -20px;           /* extend beyond to ensure full blur */
border-radius: 50%;
pointer-events: none;
background: radial-gradient(
  circle at center,
  var(--hue) 0%,
  color-mix(in srgb, var(--hue) 60%, transparent) 40%,
  transparent 80%
);
filter: blur(20px);
opacity: .3;
}

/* ═════════════ SVG PRIMITIVES ═══════════════════════════════ */
.kai-svg {
width: 100%;
height: 100%;
overflow: visible;
}
.rim-ring,
.day-progress,
.inner-halo,
.needle,
.micro-orb,
.beat-dot,
.arc-label,
.center-pulse,
.day-of-month {
paint-order: stroke fill;
}

/* Rim */
.rim-ring {
fill: none;
stroke: var(--core);
stroke-width: clamp(1.2px,0.11vw,1.5px);
filter: drop-shadow(0 0 4px var(--core));
transition: stroke-width .18s ease;
}
.rim-ring.rim-flash {
animation: rimHalo .7s cubic-bezier(.25,.46,.45,.94);
}
@keyframes rimHalo {
0%   { stroke-width: inherit; filter: drop-shadow(0 0 4px var(--flash)); }
42%  {
  stroke-width: calc(inherit*1.4);
  filter:
    drop-shadow(0 0 14px var(--flash))
    drop-shadow(0 0 38px var(--flash));
}
100% { stroke-width: inherit; filter: drop-shadow(0 0 4px var(--flash)); }
}

/* Progress ring */
@keyframes dashDrift { to { stroke-dashoffset: -28 } }
.day-progress {
fill: none;
stroke: var(--hue);
stroke-width: 1.2px;
stroke-linecap: round;
transform: rotate(-90deg);
transform-origin: center;
stroke-dasharray: 1 4;
animation: dashDrift var(--cycle) linear infinite;
opacity: .33;
filter: drop-shadow(0 0 4px var(--hue));
}

/* ─── Beat-numbers: smaller + softer glow, fully inside the circle ─── */
.beat-number {
font: 600 clamp(0.35rem, 1vw, 0.5rem)/1 "Nunito", Inter, sans-serif;
fill: currentColor;
text-shadow:
  0 0 2px currentColor,
  0 0 6px color-mix(in srgb, currentColor 60%, transparent);
text-anchor: middle;
dominant-baseline: middle;
pointer-events: none;
}

@media (hover:hover) {
.beat-dot:hover {
  filter:
    drop-shadow(0 0 4px currentColor)
    drop-shadow(0 0 10px currentColor);
}
}

/* Inner halo */
.inner-halo {
fill: none;
stroke: var(--arc);
stroke-width: 1.15px;
filter:
  drop-shadow(0 0 6px var(--arc))
  drop-shadow(0 0 18px color-mix(in srgb,var(--arc) 55%,transparent));
}

/* Needle */
.needle {
fill: var(--core);
transform-box: fill-box;
filter:
  drop-shadow(0 0 3px var(--core))
  drop-shadow(0 0 10px color-mix(in srgb,var(--core) 45%,transparent));
transition: transform var(--cycle) linear;
}

/* ─── Micro-orb: spin + breath-glow (now arc-coloured) ─────────── */
.micro-orb {
fill: var(--arc);
filter:
  drop-shadow(0 0 6px var(--arc))
  drop-shadow(0 0 18px var(--arc));
animation: klockBreath var(--cycle) ease-in-out infinite;
}
.orb-spin {
animation: orbSpin var(--cycle) linear infinite;
transform-origin: 60px 60px;
}
@keyframes orbSpin { to { transform: rotate(360deg); } }

/* Arc Label Palette */
.arc-ignition      { --arc: #ff1559; }
.arc-integrate,
.arc-integration  { --arc: #ff6d00; }
.arc-harmony,
.arc-harmonization{ --arc: #ffd900; }
.arc-reflektion   { --arc: #00ff66; }
.arc-purify,
.arc-purifikation { --arc: #05e6ff; }
.arc-dream        { --arc: #c300ff; }

.arc-label {
font: 600 .42rem/1 "Nunito",Inter,sans-serif;  /* reduced size */
fill: var(--arc);
text-shadow:
  0 0 3px var(--arc),
  0 0 10px color-mix(in srgb,var(--arc) 60%,transparent);
pointer-events: none;
}
.arc-label.active {
text-shadow:
  0 0 6px var(--arc),
  0 0 20px var(--arc),
  0 0 38px color-mix(in srgb,var(--arc) 80%,transparent);
}

/* Pulse number */
.center-pulse {
font: 700 .95rem/1 "Nunito",Inter,sans-serif;  /* slightly smaller */
fill: var(--flash);
text-shadow:
  0 0 5px var(--flash),
  0 0 18px var(--flash);
}
@keyframes pulseGlow {
0%,100% { text-shadow: 0 0 5px var(--flash), 0 0 18px var(--flash); }
35%     { text-shadow: 0 0 12px var(--flash), 0 0 42px var(--flash); }
}
.pulse-flash {
animation: pulseGlow .7s cubic-bezier(.25,.46,.45,.94);
animation-fill-mode: both;
}
.eternal-pulse {
  font-size: 5.25px;              /* Bigger but still proportional */
  fill: #77faff;                  /* Glow-cyan */
  font-family: var(--font-mono, monospace);
  font-weight: bold;
  opacity: 0.92;
  pointer-events: none;
  dominant-baseline: middle;
}

/* Calendar titles */
.center-day,
.center-month {
font: 600 .66rem/1 "Nunito",Inter,sans-serif;
fill: var(--cal);
text-shadow:
  0 0 4px var(--cal),
  0 0 14px color-mix(in srgb,var(--cal) 70%,transparent);
pointer-events: none;
}

/* ─── Day-of-Month Indicator ───────────────────────────────── */
.day-of-month {
font: 600 .50rem/1 "Nunito", Inter, sans-serif;
fill: var(--cal);
text-shadow:
  0 0 3px var(--cal),
  0 0 8px color-mix(in srgb,var(--cal) 60%,transparent);
text-anchor: middle;
dominant-baseline: middle;
pointer-events: none;
}

/* Loading fallback */
.klock-loading {
text-align: center;
font: 600 .72rem/1 "Nunito",Inter,sans-serif;
color: #82e6ff;
text-shadow:
  0 0 2px rgba(130,230,255,0.45),
  0 0 4px rgba(130,230,255,0.25);
}

/* Reduced-motion fallback */
@media (prefers-reduced-motion: reduce) {
.kai-klock-shell,
.day-progress,
.orb-spin,
.micro-orb,
.rim-ring.rim-flash,
.pulse-flash {
  animation: none !important;
  transition: none  !important;
}
}
/* ─── Sub-label under “Ignite” ─────────────────────────────────── */
.solar-Spiral-step {
  font-family: "Inter", sans-serif;
  font-size: 6px;             /* matches the <text fontSize={2}> in your JSX */
  fill: var(--arc);           /* same color as the active arc */
  opacity: 0.6;               /* subtle */
  pointer-events: none;       /* so it never intercepts mouse/touch */
  text-anchor: middle;        /* center-align inside the SVG */
}

/* if you want a slight drop shadow for legibility: */
.solar-Spiral-step {
  /* …other props… */
  filter: drop-shadow(0 0 0.5px rgba(0, 0, 0, 0.4));
}
/* ─── Solar Spiral Step sub‐label beneath “Ignite” ───────────────────────────────── */
.kai-klock-shell .kai-svg text.solar-Spiral-step {
  /* bump up from 2px so it’s legible on a 120px dial */
  font-size: 6px !important;    
  /* use the current arc colour (falls back to white if something goes wrong) */
  fill: var(--arc, #fff) !important;
  /* gently let it fade into the neon glow behind */
  opacity: 0.8 !important;
  /* center-align in SVG space */
  text-anchor: middle;
  /* optional tiny drop shadow to pop off very dark backgrounds */
  filter: drop-shadow(0 0 1px rgba(0,0,0,0.6));
  pointer-events: none;
}
/* ─── Solar‐Spiral‐Step sub‐label beneath “Ignite” ───────────────────────────────── */
svg.kai-svg text.solar-Spiral-step {
  /* make it big enough to read */
  font-size: 12px !important;
  /* use the current arc color */
  fill: var(--arc, #fff) !important;
  /* fully visible */
  opacity: 1 !important;
  /* center‐align on the X axis */
  text-anchor: middle !important;
  /* position from the top of the text, not the baseline */
  dominant-baseline: hanging !important;
  /* give it a tiny drop‐shadow to pop off the dark dial */
  filter: drop-shadow(0 0 1px rgba(0,0,0,0.7)) !important;
  /* ensure it’s not inadvertently hidden */
  display: inline !important;
  visibility: visible !important;
  pointer-events: none; 
  user-select: none;
}
@keyframes pulse-glow {
  0%, 100% { transform: scale(1); opacity: 1; }
  50% { transform: scale(1.08); opacity: 0.85; }
}
.klock-controls button {
  background: #000;
  color: #00faff;
  border: 1px solid #00faff;
  padding: 4px 10px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s ease;
}

.klock-controls button:hover {
  background: #00faff;
  color: #000;
}

.glyph-modal {
  margin-top: 12px;
  padding: 12px;
  border: 2px dashed #00faff;
  background: rgba(0, 0, 0, 0.8);
  color: #00faff;
  border-radius: 10px;
  text-align: center;
}
.eternal-hand-label{
  /* vertical upright characters riding along the hand */
  writing-mode: vertical-rl;
  text-orientation: upright;

  /* keep the crisp neon look */
  text-transform: uppercase;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
}
/* Eternal hand — base shaft stays white; cyan overlay fills live */
.eternal-hand {
  transition: filter 120ms linear; /* visual shimmer only */
}

.eternal-hand-fill {
  /* Neon cyan; lives on top of .eternal-hand as the fill overlay */
  /* We animate via JS geometry updates, so we just give it glow + blending */
  filter: drop-shadow(0 0 3px rgba(0,250,255,0.9)) drop-shadow(0 0 10px rgba(0,250,255,0.8));
  mix-blend-mode: screen;
  /* (SVG attribute height/y are updated in TSX each pulse/step) */
}

.eternal-hand-step-label {
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  letter-spacing: 0.4px;
  text-transform: none;
}

/* Optional: subtle brightness bump as we approach step rollover */
.eternal-hand-group:has(.eternal-hand-fill) {
  /* No layout change; just a tiny lift near end-of-step if you later add a class */
}
/* ────────────────────────────────────────────────────────────────
   Eternal Hand (Etherik) — fill toward next beat
   Works with existing <rect class="eternal-hand-fill"> height/y
   No TSX changes required.
──────────────────────────────────────────────────────────────── */

:root{
  --etherik-fill:   #ebfdff;  /* soft neon cyan-white */
  --etherik-stroke: #bff7ff;
  --etherik-glow-a: rgba(234, 255, 255, 0.85);
  --etherik-glow-b: rgba(200, 251, 255, 0.75);
  --etherik-shadow: 0 0 2px var(--etherik-glow-a),
                    0 0 5px var(--etherik-glow-b),
                    0 0 10px var(--etherik-glow-b);
}

/* Group inherits rotation from TSX; we just enable smooth visual compositing */
.eternal-hand-group{
  mix-blend-mode: screen;
  pointer-events: none;
}

/* Outline of the hand stays razor-crisp at any scale */
.eternal-hand{
  vector-effect: non-scaling-stroke;
  shape-rendering: geometricPrecision;
  stroke-linecap: round;
  stroke-linejoin: round;
  filter: drop-shadow(0 0 2px var(--etherik-glow-a))
          drop-shadow(0 0 6px var(--etherik-glow-b));
}

/* The fill rectangle grows upward as you update height/y from TSX.
   We add buttery transitions so it feels alive and breath-synced. */
.eternal-hand-fill{
  vector-effect: non-scaling-stroke;
  shape-rendering: geometricPrecision;
  /* Smooth growth & slight easing when the percent jumps */
  transition:
    height 0.55s cubic-bezier(.22,.61,.36,1),
    y      0.55s cubic-bezier(.22,.61,.36,1),
    opacity 0.25s ease-out;
  will-change: height, y, opacity;
  filter: drop-shadow(0 0 3px var(--etherik-glow-a))
          drop-shadow(0 0 6px var(--etherik-glow-a));
  /* Subtle breathing shimmer along the column */
  mask-image: linear-gradient(to top,
      rgba(0,0,0,0.65) 0%,
      rgba(0,0,0,0.9)  6%,
      rgba(0,0,0,1)   22%,
      rgba(0,0,0,1)   78%,
      rgba(0,0,0,0.92) 94%,
      rgba(0,0,0,0.70) 100%);
  -webkit-mask-image: linear-gradient(to top,
      rgba(0,0,0,0.65) 0%,
      rgba(0,0,0,0.9)  6%,
      rgba(0,0,0,1)   22%,
      rgba(0,0,0,1)   78%,
      rgba(0,0,0,0.92) 94%,
      rgba(0,0,0,0.70) 100%);
}

/* Tip jewel aura */
.eternal-hand-tip{
  filter: drop-shadow(0 0 4px var(--etherik-glow-a))
          drop-shadow(0 0 8px var(--etherik-glow-b));
}

/* Upright on-hand labels: crisp, legible, and glowing */
.eternal-hand-label,
.eternal-hand-percent{
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif;
  text-rendering: geometricPrecision;
  letter-spacing: .02em;
  paint-order: stroke;
  stroke: rgba(0,0,0,0.45);
  vector-effect: non-scaling-stroke;
}

.eternal-hand-label{
  filter: drop-shadow(0 0 2px var(--etherik-glow-a))
          drop-shadow(0 0 5px var(--etherik-glow-b));
}

.eternal-hand-percent{
  filter: drop-shadow(0 0 2px var(--etherik-glow-a));
}

/* Optional: tiny “living” glint on the column to suggest upward motion */
.eternal-hand-fill::after{
  content: "";
  position: absolute; /* has no effect in SVG; kept for future HTML fallback */
}

/* When the rim flashes, let Etherik brighten a touch as well (nice sync) */
.rim-flash ~ .eternal-hand-group .eternal-hand-fill{
  opacity: 0.95;
  transition-duration: 0.38s;
}
/* Force horizontal text on all devices */
.eternal-hand-label,
.eternal-hand-label-digit,
.eternal-hand-percent {
  writing-mode: horizontal-tb !important;
  text-orientation: mixed !important;
  direction: ltr !important;
  white-space: pre !important;
}

/* If you previously had mobile overrides making it vertical, remove them.
   As an extra safeguard, keep the same forced rules inside any media query. */
@media (max-width: 9999px) {
  .eternal-hand-label,
  .eternal-hand-label-digit,
  .eternal-hand-percent {
    writing-mode: horizontal-tb !important;
    text-orientation: mixed !important;
    direction: ltr !important;
  }
}
/* 3D stage with top/bottom domes */
.klock-stage.depth-3d {
  background: radial-gradient(120% 180% at 50% 10%, rgba(0, 255, 255, 0.10), transparent 60%),
              radial-gradient(120% 180% at 50% 90%, rgba(0, 255, 255, 0.10), transparent 60%);
  box-shadow:
    0 24px 60px rgba(0, 0, 0, 0.45),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

/* Soft elliptical glow at top */
.klock-stage.depth-3d::before,
.klock-stage.depth-3d::after {
  content: "";
  position: absolute;
  left: 8%;
  right: 8%;
  height: 30%;
  border-radius: 50%;
  pointer-events: none;
  filter: blur(22px);
  opacity: 0.9;
}

/* Top dome */
.klock-stage.depth-3d::before {
  top: 4%;
  background: radial-gradient(80% 120% at 50% 100%,
              rgba(0, 255, 255, 0.22), rgba(0, 255, 255, 0.06) 60%, transparent 70%);
}

/* Bottom dome */
.klock-stage.depth-3d::after {
  bottom: 4%;
  background: radial-gradient(80% 120% at 50% 0%,
              rgba(0, 255, 255, 0.22), rgba(0, 255, 255, 0.06) 60%, transparent 70%);
}

/* Make sure the SVG scales perfectly inside */
.kai-klock-shell .kai-svg {
  display: block;
  width: 100%;
  height: 100%;
}
/* ==== BIG HOME DIAL (fills the large panel) =================== */
.eternal-klock-panel {
  display: grid;
  place-items: center;
}

/* Blow past the 120px cap and scale as a big square */
.eternal-klock-panel .kai-klock-shell {
  max-width: none !important;
  width: clamp(260px, 82vmin, 1200px) !important; /* big but safe */
  aspect-ratio: 1 / 1;
  height: auto;
  margin: 0;
}
