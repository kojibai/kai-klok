(()=>{var g="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",u=r=>Array.from(r).map(i=>i.toString(16).padStart(2,"0")).join("");async function o(r){let i=typeof r=="string"?new TextEncoder().encode(r):r,n=await crypto.subtle.digest("SHA-256",i);return u(new Uint8Array(n))}function l(r){let i=0n;for(let e of r)i=(i<<8n)+BigInt(e);let n="";for(;i>0n;){let e=Number(i%58n);n=g[e]+n,i/=58n}for(let e=0;e<r.length&&r[e]===0;e++)n="1"+n;return n}async function d(r,i=0){let n=new Uint8Array(1+r.length);n[0]=i,n.set(r,1);let e=await crypto.subtle.digest("SHA-256",n),t=await crypto.subtle.digest("SHA-256",e),f=new Uint8Array(t).slice(0,4),a=new Uint8Array(n.length+4);return a.set(n),a.set(f,n.length),l(a)}async function s(r){let i=await o(r+"\u03C6"),n=new Uint8Array(20);for(let e=0;e<20;e++)n[e]=parseInt(i.slice(e*2,e*2+2),16);return d(n,0)}function c(r,i,n,e,t){return`${r}|${i}|${n}|${e}|${t??""}`}var m=(r,i,n,e,t)=>c(r,i,n,e,t??void 0),S={sha256HexCanon:o,derivePhiKeyFromSigCanon:s,verifierSigmaString:m};Object.defineProperty(globalThis,"KaiVerifier",{value:S,writable:!1,enumerable:!1,configurable:!0});})();
